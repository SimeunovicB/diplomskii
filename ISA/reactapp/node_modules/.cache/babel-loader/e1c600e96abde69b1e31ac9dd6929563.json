{"ast":null,"code":"var _jsxFileName = \"G:\\\\FAKS PREDMETI\\\\diplomskii\\\\ISA\\\\reactapp\\\\src\\\\components\\\\results\\\\AddResultsForFightsList.js\",\n    _s = $RefreshSig$();\n\n// import FightItem from \"./FightItem\";\nimport AddResultsForFightsItem from \"./AddResultsForFightsItem\";\nimport classes from \"./AddResultsForFightsList.module.css\";\nimport { useLocation, useHistory } from \"react-router-dom\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Card from \"../ui/Card\";\nimport Web3 from \"web3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction AddResultsForFightsList() {\n  _s();\n\n  const location = useLocation();\n  const history = useHistory();\n  console.log(location.state.eventId);\n  const [fights, setFights] = useState([]);\n  const [walletAddressAndPrizeMap, setWalletAddressAndPrizeMap] = useState([]);\n  const fightsResults = new Map(); // fightsResults.set(\"a\", [1,13]);\n  // fightsResults.set(\"b\", [2,18]);\n  // fightsResults.set(\"c\", [3,-4]);\n\n  let returnFightIds = [];\n  let returnWinnerIds = [];\n  let returnMethods = [];\n  useEffect(() => {\n    myFunction();\n    return () => {\n      setWalletAddressAndPrizeMap({}); // This worked for me\n    };\n  }, []);\n  useEffect(() => {\n    axios({\n      method: \"get\",\n      url: \"api/fights/event?eventId=\" + location.state.eventId\n    }).then(response => {\n      console.log(response);\n      console.log(response.data);\n      const fights = response.data;\n      setFights(fights);\n    }).catch(error => {\n      console.log(error);\n    });\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n  //   console.log(\"FAJTERI U FIGHTER LIST\", props.fights);\n\n  async function loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum);\n      window.ethereum.enable();\n      console.log(\"USAO U IF\");\n    }\n\n    console.log(\"USAO U loadWeb3\");\n  }\n\n  async function loadContract() {\n    console.log(\"VERZIJA WEB3\");\n    console.log(window.web3.version);\n    return await new window.web3.eth.Contract([{\n      constant: true,\n      inputs: [],\n      name: \"name\",\n      outputs: [{\n        name: \"\",\n        type: \"string\"\n      }],\n      payable: false,\n      stateMutability: \"view\",\n      type: \"function\"\n    }, {\n      constant: false,\n      inputs: [{\n        name: \"_spender\",\n        type: \"address\"\n      }, {\n        name: \"_value\",\n        type: \"uint256\"\n      }],\n      name: \"approve\",\n      outputs: [{\n        name: \"\",\n        type: \"bool\"\n      }],\n      payable: false,\n      stateMutability: \"nonpayable\",\n      type: \"function\"\n    }, {\n      constant: true,\n      inputs: [],\n      name: \"totalSupply\",\n      outputs: [{\n        name: \"\",\n        type: \"uint256\"\n      }],\n      payable: false,\n      stateMutability: \"view\",\n      type: \"function\"\n    }, {\n      constant: false,\n      inputs: [{\n        name: \"_from\",\n        type: \"address\"\n      }, {\n        name: \"_to\",\n        type: \"address\"\n      }, {\n        name: \"_value\",\n        type: \"uint256\"\n      }],\n      name: \"transferFrom\",\n      outputs: [{\n        name: \"\",\n        type: \"bool\"\n      }],\n      payable: false,\n      stateMutability: \"nonpayable\",\n      type: \"function\"\n    }, {\n      constant: true,\n      inputs: [],\n      name: \"decimals\",\n      outputs: [{\n        name: \"\",\n        type: \"uint8\"\n      }],\n      payable: false,\n      stateMutability: \"view\",\n      type: \"function\"\n    }, {\n      constant: true,\n      inputs: [{\n        name: \"_owner\",\n        type: \"address\"\n      }],\n      name: \"balanceOf\",\n      outputs: [{\n        name: \"balance\",\n        type: \"uint256\"\n      }],\n      payable: false,\n      stateMutability: \"view\",\n      type: \"function\"\n    }, {\n      constant: true,\n      inputs: [],\n      name: \"symbol\",\n      outputs: [{\n        name: \"\",\n        type: \"string\"\n      }],\n      payable: false,\n      stateMutability: \"view\",\n      type: \"function\"\n    }, {\n      constant: false,\n      inputs: [{\n        name: \"_to\",\n        type: \"address\"\n      }, {\n        name: \"_value\",\n        type: \"uint256\"\n      }],\n      name: \"transfer\",\n      outputs: [{\n        name: \"\",\n        type: \"bool\"\n      }],\n      payable: false,\n      stateMutability: \"nonpayable\",\n      type: \"function\"\n    }, {\n      constant: true,\n      inputs: [{\n        name: \"_owner\",\n        type: \"address\"\n      }, {\n        name: \"_spender\",\n        type: \"address\"\n      }],\n      name: \"allowance\",\n      outputs: [{\n        name: \"\",\n        type: \"uint256\"\n      }],\n      payable: false,\n      stateMutability: \"view\",\n      type: \"function\"\n    }, {\n      payable: true,\n      stateMutability: \"payable\",\n      type: \"fallback\"\n    }, {\n      anonymous: false,\n      inputs: [{\n        indexed: true,\n        name: \"owner\",\n        type: \"address\"\n      }, {\n        indexed: true,\n        name: \"spender\",\n        type: \"address\"\n      }, {\n        indexed: false,\n        name: \"value\",\n        type: \"uint256\"\n      }],\n      name: \"Approval\",\n      type: \"event\"\n    }, {\n      anonymous: false,\n      inputs: [{\n        indexed: true,\n        name: \"from\",\n        type: \"address\"\n      }, {\n        indexed: true,\n        name: \"to\",\n        type: \"address\"\n      }, {\n        indexed: false,\n        name: \"value\",\n        type: \"uint256\"\n      }],\n      name: \"Transfer\",\n      type: \"event\"\n    }], \"0x3e6c08800313ae6a225a3f72c691bc4ce971dd03\");\n  }\n\n  async function load() {\n    console.log(\"EVO GA\");\n    await loadWeb3();\n    window.contract = await loadContract();\n    console.log(window.contract);\n    console.log(window.contract.methods);\n    console.log(\"USAO U LOAD u ADD RESULTS FOR FIGHTS LIST\");\n  }\n\n  load(this);\n\n  const changeResultsHandler = (fightId, winnerId, winningMethod) => {\n    console.log(\"changeResultsHandler\");\n    console.log(\"FIGHT ID \", fightId);\n    console.log(\"WINNER ID \", winnerId);\n    console.log(\"WINNING METHOD \", winningMethod);\n    fightsResults.set(fightId, [winnerId, winningMethod]);\n  };\n\n  async function submitHandler() {\n    console.log(\"ide gas\"); // let walletAddressAndPrizeMap = null;\n\n    function logMapElements(value, key) {\n      returnFightIds.push(key);\n      returnWinnerIds.push(value[0]);\n      returnMethods.push(value[1]);\n    }\n\n    fightsResults.forEach(logMapElements);\n    console.log(returnFightIds);\n    console.log(returnWinnerIds);\n    console.log(returnMethods); // (async () => {\n    //   const response = await fetch(\"http://127.0.0.1:8000/api/results/event\", {\n    //     headers: { \"Content-Type\": \"application/json\" },\n    //     credentials: \"include\",\n    //     method: \"put\",\n    //     body: JSON.stringify({\n    //       fightIds: returnFightIds,\n    //       winnerIds: returnWinnerIds,\n    //       methods: returnMethods,\n    //     }),\n    //   });\n    //   const map = await response.json();\n    //   console.log(\"IDE CONTENT\", map);\n    //   console.log(\"MAPA \", map);\n    //     console.log(\"TIP MAPE \", typeof map);\n    //     walletAddressAndPrizeMap = map;\n    //     console.log(\"PRIMIO GA \", walletAddressAndPrizeMap);\n    // })();\n\n    axios({\n      method: \"put\",\n      url: \"api/results/event\",\n      data: {\n        fightIds: returnFightIds,\n        winnerIds: returnWinnerIds,\n        methods: returnMethods\n      }\n    }).then(response => {\n      console.log(response);\n      console.log(\"jesam tu sam\");\n      let map = response.data; //key = walletAddress, value = amount of coins to add\n\n      console.log(\"MAPA \", map);\n      console.log(\"TIP MAPE \", typeof map); // walletAddressAndPrizeMap = map;\n      // console.log(\"PRIMIO GA \", walletAddressAndPrizeMap);\n\n      const myFunction = () => {\n        setWalletAddressAndPrizeMap(map);\n      }; //\n      // console.log(mapa['a'])\n      // console.log(mapa[1])\n\n    }).catch(error => {\n      console.log(error);\n    });\n    let transferSuccess;\n    console.log(\"PRED FOR \", walletAddressAndPrizeMap); // for (let [key, value] of walletAddressAndPrizeMap) {\n\n    for (const [key, value] of Object.entries(walletAddressAndPrizeMap)) {\n      console.log(\"in \" + key + \" add \" + value);\n      console.log(\"TIP \", typeof value); // if(value !== 0) {\n\n      try {\n        transferSuccess = await window.contract.methods.transfer(key, value * 100 //ovde ide puta 100 zbog dve decimale iza zagrade kod Perper-a\n        ).send({\n          from: \"0x7f78c74b3C360d9452E94051C302e491A042024f\"\n        });\n      } catch {\n        console.log(\"Transaction failed!\");\n      }\n\n      console.log(transferSuccess); // }\n    }\n\n    history.replace(\"/past-events-and-fights\");\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.form,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.content,\n          children: /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: location.state.eventName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: classes.list,\n          children: fights.map(fight => /*#__PURE__*/_jsxDEV(AddResultsForFightsItem, {\n            id: fight.id,\n            redCornerFighter: fight.redCornerFighter,\n            blueCornerFighter: fight.blueCornerFighter,\n            redCornerOdds: fight.redCornerOdds,\n            event: fight.event,\n            changeResults: changeResultsHandler\n          }, fight.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.actions,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: submitHandler,\n            children: \"Add result\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 400,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AddResultsForFightsList, \"I1uO9U/ed/vQJuwlOyXpYjbDUIE=\", false, function () {\n  return [useLocation, useHistory];\n});\n\n_c = AddResultsForFightsList;\nexport default AddResultsForFightsList;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddResultsForFightsList\");","map":{"version":3,"sources":["G:/FAKS PREDMETI/diplomskii/ISA/reactapp/src/components/results/AddResultsForFightsList.js"],"names":["AddResultsForFightsItem","classes","useLocation","useHistory","useState","useEffect","axios","Card","Web3","AddResultsForFightsList","location","history","console","log","state","eventId","fights","setFights","walletAddressAndPrizeMap","setWalletAddressAndPrizeMap","fightsResults","Map","returnFightIds","returnWinnerIds","returnMethods","myFunction","method","url","then","response","data","catch","error","loadWeb3","window","ethereum","web3","enable","loadContract","version","eth","Contract","constant","inputs","name","outputs","type","payable","stateMutability","anonymous","indexed","load","contract","methods","changeResultsHandler","fightId","winnerId","winningMethod","set","submitHandler","logMapElements","value","key","push","forEach","fightIds","winnerIds","map","transferSuccess","Object","entries","transfer","send","from","replace","form","content","eventName","list","fight","id","redCornerFighter","blueCornerFighter","redCornerOdds","event","actions"],"mappings":"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","sourcesContent":["// import FightItem from \"./FightItem\";\r\nimport AddResultsForFightsItem from \"./AddResultsForFightsItem\";\r\nimport classes from \"./AddResultsForFightsList.module.css\";\r\nimport { useLocation, useHistory } from \"react-router-dom\";\r\nimport { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport Card from \"../ui/Card\";\r\nimport Web3 from \"web3\";\r\n\r\nfunction AddResultsForFightsList() {\r\n  const location = useLocation();\r\n  const history = useHistory();\r\n  console.log(location.state.eventId);\r\n\r\n  const [fights, setFights] = useState([]);\r\n  const [walletAddressAndPrizeMap, setWalletAddressAndPrizeMap] = useState([]);\r\n  const fightsResults = new Map();\r\n  // fightsResults.set(\"a\", [1,13]);\r\n  // fightsResults.set(\"b\", [2,18]);\r\n  // fightsResults.set(\"c\", [3,-4]);\r\n\r\n  let returnFightIds = [];\r\n  let returnWinnerIds = [];\r\n  let returnMethods = [];\r\n\r\n  useEffect(() => {\r\n    myFunction();\r\n    return () => {\r\n      setWalletAddressAndPrizeMap({}); // This worked for me\r\n    };\r\n}, []);\r\n\r\n  useEffect(() => {\r\n    axios({\r\n      method: \"get\",\r\n      url: \"api/fights/event?eventId=\" + location.state.eventId,\r\n    })\r\n      .then((response) => {\r\n        console.log(response);\r\n        console.log(response.data);\r\n        const fights = response.data;\r\n        setFights(fights);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  //   console.log(\"FAJTERI U FIGHTER LIST\", props.fights);\r\n\r\n  async function loadWeb3() {\r\n    if (window.ethereum) {\r\n      window.web3 = new Web3(window.ethereum);\r\n      window.ethereum.enable();\r\n      console.log(\"USAO U IF\");\r\n    }\r\n    console.log(\"USAO U loadWeb3\");\r\n  }\r\n\r\n  async function loadContract() {\r\n    console.log(\"VERZIJA WEB3\");\r\n    console.log(window.web3.version);\r\n    return await new window.web3.eth.Contract(\r\n      [\r\n        {\r\n          constant: true,\r\n          inputs: [],\r\n          name: \"name\",\r\n          outputs: [\r\n            {\r\n              name: \"\",\r\n              type: \"string\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"view\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          constant: false,\r\n          inputs: [\r\n            {\r\n              name: \"_spender\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              name: \"_value\",\r\n              type: \"uint256\",\r\n            },\r\n          ],\r\n          name: \"approve\",\r\n          outputs: [\r\n            {\r\n              name: \"\",\r\n              type: \"bool\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"nonpayable\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          constant: true,\r\n          inputs: [],\r\n          name: \"totalSupply\",\r\n          outputs: [\r\n            {\r\n              name: \"\",\r\n              type: \"uint256\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"view\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          constant: false,\r\n          inputs: [\r\n            {\r\n              name: \"_from\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              name: \"_to\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              name: \"_value\",\r\n              type: \"uint256\",\r\n            },\r\n          ],\r\n          name: \"transferFrom\",\r\n          outputs: [\r\n            {\r\n              name: \"\",\r\n              type: \"bool\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"nonpayable\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          constant: true,\r\n          inputs: [],\r\n          name: \"decimals\",\r\n          outputs: [\r\n            {\r\n              name: \"\",\r\n              type: \"uint8\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"view\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          constant: true,\r\n          inputs: [\r\n            {\r\n              name: \"_owner\",\r\n              type: \"address\",\r\n            },\r\n          ],\r\n          name: \"balanceOf\",\r\n          outputs: [\r\n            {\r\n              name: \"balance\",\r\n              type: \"uint256\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"view\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          constant: true,\r\n          inputs: [],\r\n          name: \"symbol\",\r\n          outputs: [\r\n            {\r\n              name: \"\",\r\n              type: \"string\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"view\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          constant: false,\r\n          inputs: [\r\n            {\r\n              name: \"_to\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              name: \"_value\",\r\n              type: \"uint256\",\r\n            },\r\n          ],\r\n          name: \"transfer\",\r\n          outputs: [\r\n            {\r\n              name: \"\",\r\n              type: \"bool\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"nonpayable\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          constant: true,\r\n          inputs: [\r\n            {\r\n              name: \"_owner\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              name: \"_spender\",\r\n              type: \"address\",\r\n            },\r\n          ],\r\n          name: \"allowance\",\r\n          outputs: [\r\n            {\r\n              name: \"\",\r\n              type: \"uint256\",\r\n            },\r\n          ],\r\n          payable: false,\r\n          stateMutability: \"view\",\r\n          type: \"function\",\r\n        },\r\n        {\r\n          payable: true,\r\n          stateMutability: \"payable\",\r\n          type: \"fallback\",\r\n        },\r\n        {\r\n          anonymous: false,\r\n          inputs: [\r\n            {\r\n              indexed: true,\r\n              name: \"owner\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              indexed: true,\r\n              name: \"spender\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              indexed: false,\r\n              name: \"value\",\r\n              type: \"uint256\",\r\n            },\r\n          ],\r\n          name: \"Approval\",\r\n          type: \"event\",\r\n        },\r\n        {\r\n          anonymous: false,\r\n          inputs: [\r\n            {\r\n              indexed: true,\r\n              name: \"from\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              indexed: true,\r\n              name: \"to\",\r\n              type: \"address\",\r\n            },\r\n            {\r\n              indexed: false,\r\n              name: \"value\",\r\n              type: \"uint256\",\r\n            },\r\n          ],\r\n          name: \"Transfer\",\r\n          type: \"event\",\r\n        },\r\n      ],\r\n      \"0x3e6c08800313ae6a225a3f72c691bc4ce971dd03\"\r\n    );\r\n  }\r\n\r\n  async function load() {\r\n    console.log(\"EVO GA\");\r\n    await loadWeb3();\r\n    window.contract = await loadContract();\r\n    console.log(window.contract);\r\n    console.log(window.contract.methods);\r\n    console.log(\"USAO U LOAD u ADD RESULTS FOR FIGHTS LIST\");\r\n  }\r\n\r\n  load(this);\r\n\r\n  const changeResultsHandler = (fightId, winnerId, winningMethod) => {\r\n    console.log(\"changeResultsHandler\");\r\n    console.log(\"FIGHT ID \", fightId);\r\n    console.log(\"WINNER ID \", winnerId);\r\n    console.log(\"WINNING METHOD \", winningMethod);\r\n    fightsResults.set(fightId, [winnerId, winningMethod]);\r\n  };\r\n\r\n  async function submitHandler() {\r\n    console.log(\"ide gas\");\r\n    // let walletAddressAndPrizeMap = null;\r\n\r\n    function logMapElements(value, key) {\r\n      returnFightIds.push(key);\r\n      returnWinnerIds.push(value[0]);\r\n      returnMethods.push(value[1]);\r\n    }\r\n\r\n    fightsResults.forEach(logMapElements);\r\n\r\n    console.log(returnFightIds);\r\n    console.log(returnWinnerIds);\r\n    console.log(returnMethods);\r\n\r\n\r\n\r\n    // (async () => {\r\n    //   const response = await fetch(\"http://127.0.0.1:8000/api/results/event\", {\r\n    //     headers: { \"Content-Type\": \"application/json\" },\r\n    //     credentials: \"include\",\r\n    //     method: \"put\",\r\n    //     body: JSON.stringify({\r\n    //       fightIds: returnFightIds,\r\n    //       winnerIds: returnWinnerIds,\r\n    //       methods: returnMethods,\r\n    //     }),\r\n    //   });\r\n    //   const map = await response.json();\r\n    //   console.log(\"IDE CONTENT\", map);\r\n    //   console.log(\"MAPA \", map);\r\n    //     console.log(\"TIP MAPE \", typeof map);\r\n    //     walletAddressAndPrizeMap = map;\r\n    //     console.log(\"PRIMIO GA \", walletAddressAndPrizeMap);\r\n    // })();\r\n\r\n    axios({\r\n      method: \"put\",\r\n      url: \"api/results/event\",\r\n      data: {\r\n        fightIds: returnFightIds,\r\n        winnerIds: returnWinnerIds,\r\n        methods: returnMethods,\r\n      },\r\n    })\r\n      .then((response) => {\r\n        console.log(response);\r\n        console.log(\"jesam tu sam\");\r\n        let map = response.data; //key = walletAddress, value = amount of coins to add\r\n        console.log(\"MAPA \", map);\r\n        console.log(\"TIP MAPE \", typeof map);\r\n        // walletAddressAndPrizeMap = map;\r\n        // console.log(\"PRIMIO GA \", walletAddressAndPrizeMap);\r\n        \r\n        const myFunction = () => {\r\n          setWalletAddressAndPrizeMap(map);\r\n      }\r\n        //\r\n        // console.log(mapa['a'])\r\n        // console.log(mapa[1])\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n\r\n    let transferSuccess;\r\n    console.log(\"PRED FOR \", walletAddressAndPrizeMap);\r\n    // for (let [key, value] of walletAddressAndPrizeMap) {\r\n    for (const [key, value] of Object.entries(walletAddressAndPrizeMap)) {\r\n      console.log(\"in \" + key + \" add \" + value);\r\n      console.log(\"TIP \", typeof value);\r\n      // if(value !== 0) {\r\n      try {\r\n        transferSuccess = await window.contract.methods\r\n          .transfer(\r\n            key,\r\n            value * 100 //ovde ide puta 100 zbog dve decimale iza zagrade kod Perper-a\r\n          )\r\n          .send({ from: \"0x7f78c74b3C360d9452E94051C302e491A042024f\" });\r\n      } catch {\r\n        console.log(\"Transaction failed!\");\r\n      }\r\n      console.log(transferSuccess);\r\n\r\n      // }\r\n    }\r\n    history.replace(\"/past-events-and-fights\");\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Card>\r\n        <div className={classes.form}>\r\n          <div className={classes.content}>\r\n            <h2>{location.state.eventName}</h2>\r\n          </div>\r\n          <ul className={classes.list}>\r\n            {fights.map((fight) => (\r\n              <AddResultsForFightsItem\r\n                key={fight.id}\r\n                id={fight.id}\r\n                redCornerFighter={fight.redCornerFighter}\r\n                blueCornerFighter={fight.blueCornerFighter}\r\n                redCornerOdds={fight.redCornerOdds}\r\n                event={fight.event}\r\n                changeResults={changeResultsHandler}\r\n              />\r\n            ))}\r\n          </ul>\r\n          <div className={classes.actions}>\r\n            <button onClick={submitHandler}>Add result</button>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\nexport default AddResultsForFightsList;\r\n"]},"metadata":{},"sourceType":"module"}